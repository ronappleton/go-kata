<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Learner Studio</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="bg-shape shape-a"></div>
  <div class="bg-shape shape-b"></div>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="brand">
        <h1>Learner Studio</h1>
        <p id="track-summary">Loading track...</p>
      </div>
      <section class="pathways-wrap">
        <h3>Learning Pathways</h3>
        <div id="pathway-list" class="pathway-list"></div>
      </section>
      <div id="category-list" class="category-list"></div>
    </aside>

    <main class="main">
      <header class="main-header">
        <div>
          <h2 id="kata-title">Select a kata</h2>
          <p id="kata-subtitle">Use the sidebar to start.</p>
        </div>
        <div class="actions">
          <button id="theme-btn" class="btn ghost" title="Toggle dark mode">Dark mode</button>
          <button id="focus-btn" class="btn ghost" title="Toggle focus mode">Focus mode</button>
          <button id="save-btn" class="btn ghost" disabled>Save</button>
          <button id="run-btn" class="btn primary" disabled>Run Tests</button>
          <button id="mark-btn" class="btn accent" disabled>Ask AI to Mark</button>
        </div>
      </header>

      <section class="coach-strip">
        <div class="coach-card">
          <h3>Learning Coach</h3>
          <p id="coach-message">Loading guidance...</p>
          <p id="next-recommendation" class="next-recommendation"></p>
        </div>
      </section>

      <div class="tabs">
        <button id="tab-docs" class="tab active">Documentation</button>
        <button id="tab-workbench" class="tab">Workbench</button>
        <button id="tab-flashcards" class="tab">Flashcards</button>
        <button id="tab-quiz" class="tab">Quiz</button>
        <button id="tab-bug" class="tab">Bug Hunt</button>
        <button id="tab-review" class="tab">Reflection</button>
      </div>
      <p class="shortcut-hint">Shortcuts: <kbd>Ctrl/Cmd+S</kbd> Save, <kbd>Ctrl/Cmd+Enter</kbd> Run tests, <kbd>Alt+Shift+F</kbd> Format both, <kbd>Ctrl/Cmd+Shift+M</kbd> Focus mode, <kbd>Ctrl/Cmd+F</kbd> Find in editor, <kbd>Tab</kbd> insert tab, <kbd>Esc</kbd> close modal</p>

      <section id="panel-docs" class="panel docs-panel active">
        <article id="readme-view" class="doc-view markdown-render"></article>
      </section>

      <section id="panel-workbench" class="panel workbench-panel">
        <div class="workbench-grid">
          <div class="pane">
            <div class="pane-head">
              <h3>Tests</h3>
              <button id="format-tests-btn" class="btn tiny">Format</button>
              <button id="reset-tests-btn" class="btn tiny">Reload</button>
            </div>
            <div class="pane-tools">
              <input id="tests-search-input" class="search-input" type="search" placeholder="Find in tests..." />
              <button id="tests-search-prev" class="btn tiny">Prev</button>
              <button id="tests-search-next" class="btn tiny">Next</button>
              <button id="tests-search-clear" class="btn tiny">Clear</button>
              <span id="tests-search-count" class="search-count">0/0</span>
            </div>
            <div class="editor-wrap">
              <pre id="tests-lines" class="line-number-layer"></pre>
              <pre id="tests-highlight" class="highlight-layer"></pre>
              <textarea id="tests-editor" class="highlight-input" spellcheck="false"></textarea>
            </div>
          </div>
          <div class="pane">
            <div class="pane-head">
              <h3>Code (Your Solution)</h3>
              <button id="format-code-btn" class="btn tiny">Format</button>
              <span id="dirty-indicator" class="pill">Saved</span>
            </div>
            <div class="pane-tools">
              <input id="code-search-input" class="search-input" type="search" placeholder="Find in solution..." />
              <button id="code-search-prev" class="btn tiny">Prev</button>
              <button id="code-search-next" class="btn tiny">Next</button>
              <button id="code-search-clear" class="btn tiny">Clear</button>
              <span id="code-search-count" class="search-count">0/0</span>
            </div>
            <div class="editor-wrap">
              <pre id="code-lines" class="line-number-layer"></pre>
              <pre id="code-highlight" class="highlight-layer"></pre>
              <textarea id="code-editor" class="highlight-input" spellcheck="false" placeholder="Select a kata to start coding..."></textarea>
            </div>
          </div>
        </div>
        <div class="result-wrap">
          <h3>Last Test Run</h3>
          <pre id="run-output">No run yet.</pre>
        </div>
        <div class="result-wrap">
          <h3>Failure Insights</h3>
          <div id="failure-insights" class="insights-list">
            Run tests to get focused feedback on the first behavior gap.
          </div>
        </div>
      </section>

      <section id="panel-flashcards" class="panel flashcards-panel">
        <div class="mode-head">
          <h3>Flashcards</h3>
          <div class="mode-actions">
            <button id="flash-prev-btn" class="btn tiny">Prev</button>
            <button id="flash-flip-btn" class="btn tiny">Flip</button>
            <button id="flash-next-btn" class="btn tiny">Next</button>
            <span id="flash-progress" class="pill">0/0</span>
          </div>
        </div>
        <div id="flash-card" class="flash-card">
          <p id="flash-side" class="flash-side">Front</p>
          <p id="flash-text" class="flash-text">Select a kata to load flashcards.</p>
        </div>
        <p id="flash-tag" class="flash-tag"></p>
      </section>

      <section id="panel-quiz" class="panel quiz-panel">
        <div class="mode-head">
          <h3>Knowledge Check (MCQ)</h3>
          <div class="mode-actions">
            <button id="quiz-prev-btn" class="btn tiny">Prev</button>
            <button id="quiz-next-btn" class="btn tiny">Next</button>
            <button id="quiz-reset-btn" class="btn tiny">Reset</button>
            <span id="quiz-progress" class="pill">0/0</span>
          </div>
        </div>
        <div class="quiz-card">
          <p id="quiz-prompt" class="quiz-prompt">Select a kata to load quiz questions.</p>
          <div id="quiz-options" class="quiz-options"></div>
          <p id="quiz-feedback" class="quiz-feedback"></p>
        </div>
        <p id="quiz-score" class="quiz-score"></p>
      </section>

      <section id="panel-bug" class="panel bug-panel">
        <div class="mode-head">
          <h3>Bug Hunt Mode</h3>
          <div class="mode-actions">
            <button id="bug-run-btn" class="btn tiny">Run Diagnostics</button>
            <button id="bug-reset-btn" class="btn tiny">Restore Buggy Starter</button>
          </div>
        </div>
        <div class="bug-card">
          <p id="bug-context" class="bug-context">Select a kata to start Bug Hunt mode.</p>
          <ul id="bug-rules" class="bug-rules"></ul>
          <p id="bug-tip" class="bug-tip"></p>
        </div>
      </section>

      <section id="panel-review" class="panel review-panel">
        <div class="mode-head">
          <h3>Reflection Mode</h3>
          <div class="mode-actions">
            <button id="review-save-btn" class="btn tiny">Save Reflection</button>
          </div>
        </div>
        <div class="review-card">
          <p class="review-prompt">What rule failed first, and what change fixed it?</p>
          <p class="review-prompt">Why does this behavior matter in real Go code?</p>
          <p class="review-prompt">What one habit will you carry into the next kata?</p>
          <textarea id="review-notes" class="review-notes" placeholder="Write your reflection for this kata..."></textarea>
        </div>
      </section>
    </main>
  </div>

  <div id="pass-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="pass-title">
    <div class="modal-card">
      <h3 id="pass-title">Well done</h3>
      <p>Your tests passed. Generate an AI review packet for coaching feedback.</p>
      <p id="pass-next-hint" class="next-recommendation"></p>
      <div class="modal-actions">
        <button id="pass-next-btn" class="btn accent">Open Next Recommended Kata</button>
        <button id="pass-mark-btn" class="btn primary">Generate AI Marking Packet</button>
        <button id="pass-close-btn" class="btn ghost">Close</button>
      </div>
    </div>
  </div>

  <div id="mark-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="mark-title">
    <div class="modal-card wide">
      <h3 id="mark-title">AI Marking Packet Ready</h3>
      <p id="mark-path"></p>
      <textarea id="mark-prompt" readonly spellcheck="false"></textarea>
      <div class="modal-actions">
        <button id="copy-prompt-btn" class="btn primary">Copy Prompt</button>
        <a id="open-chatgpt-link" class="btn accent" href="https://chatgpt.com/" target="_blank" rel="noreferrer">Open ChatGPT</a>
        <button id="mark-close-btn" class="btn ghost">Close</button>
      </div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
